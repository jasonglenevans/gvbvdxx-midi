(()=>{var t,e={126:function(t,e,r){t=r.nmd(t);var n={};!function(t){var e=t.DEFAULT_VOLUME=90,r=(t.DEFAULT_DURATION=128,t.DEFAULT_CHANNEL=0,{midi_letter_pitches:{a:21,b:23,c:12,d:14,e:16,f:17,g:19},midiPitchFromNote:function(t){var e=/([a-g])(#+|b+)?([0-9]+)$/i.exec(t),n=e[1].toLowerCase(),i=e[2]||"";return 12*parseInt(e[3],10)+r.midi_letter_pitches[n]+("#"==i.substr(0,1)?1:-1)*i.length},ensureMidiPitch:function(t){return"number"!=typeof t&&/[^0-9]/.test(t)?r.midiPitchFromNote(t):parseInt(t,10)},midi_pitches_letter:{12:"c",13:"c#",14:"d",15:"d#",16:"e",17:"f",18:"f#",19:"g",20:"g#",21:"a",22:"a#",23:"b"},midi_flattened_notes:{"a#":"bb","c#":"db","d#":"eb","f#":"gb","g#":"ab"},noteFromMidiPitch:function(t,e){var n,i=0,s=t;return e=e||!1,t>23&&(s=t-12*(i=Math.floor(t/12)-1)),n=r.midi_pitches_letter[s],e&&n.indexOf("#")>0&&(n=r.midi_flattened_notes[n]),n+i},mpqnFromBpm:function(t){var e=Math.floor(6e7/t),r=[];do{r.unshift(255&e),e>>=8}while(e);for(;r.length<3;)r.push(0);return r},bpmFromMpqn:function(t){if(void 0!==t[0])for(var e=0,r=t.length-1;r>=0;++e,--r)t[e];return Math.floor(6e7/t)},codes2Str:function(t){return String.fromCharCode.apply(null,t)},str2Bytes:function(t,e){if(e)for(;t.length/2<e;)t="0"+t;for(var r=[],n=t.length-1;n>=0;n-=2){var i=0===n?t[n]:t[n-1]+t[n];r.unshift(parseInt(i,16))}return r},translateTickTime:function(t){for(var e=127&t;t>>=7;)e<<=8,e|=127&t|128;for(var r=[];r.push(255&e),128&e;)e>>=8;return r}}),n=function(t){if(!this)return new n(t);!t||null===t.type&&void 0===t.type||null===t.channel&&void 0===t.channel||null===t.param1&&void 0===t.param1||(this.setTime(t.time),this.setType(t.type),this.setChannel(t.channel),this.setParam1(t.param1),this.setParam2(t.param2))};n.NOTE_OFF=128,n.NOTE_ON=144,n.AFTER_TOUCH=160,n.CONTROLLER=176,n.PROGRAM_CHANGE=192,n.CHANNEL_AFTERTOUCH=208,n.PITCH_BEND=224,n.prototype.setTime=function(t){this.time=r.translateTickTime(t||0)},n.prototype.setType=function(t){if(t<n.NOTE_OFF||t>n.PITCH_BEND)throw new Error("Trying to set an unknown event: "+t);this.type=t},n.prototype.setChannel=function(t){if(t<0||t>15)throw new Error("Channel is out of bounds.");this.channel=t},n.prototype.setParam1=function(t){this.param1=t},n.prototype.setParam2=function(t){this.param2=t},n.prototype.toBytes=function(){var t=[],e=this.type|15&this.channel;return t.push.apply(t,this.time),t.push(e),t.push(this.param1),void 0!==this.param2&&null!==this.param2&&t.push(this.param2),t};var i=function(t){if(!this)return new i(t);this.setTime(t.time),this.setType(t.type),this.setData(t.data)};i.SEQUENCE=0,i.TEXT=1,i.COPYRIGHT=2,i.TRACK_NAME=3,i.INSTRUMENT=4,i.LYRIC=5,i.MARKER=6,i.CUE_POINT=7,i.CHANNEL_PREFIX=32,i.END_OF_TRACK=47,i.TEMPO=81,i.SMPTE=84,i.TIME_SIG=88,i.KEY_SIG=89,i.SEQ_EVENT=127,i.prototype.setTime=function(t){this.time=r.translateTickTime(t||0)},i.prototype.setType=function(t){this.type=t},i.prototype.setData=function(t){this.data=t},i.prototype.toBytes=function(){if(!this.type)throw new Error("Type for meta-event not specified.");var t=[];if(t.push.apply(t,this.time),t.push(255,this.type),Array.isArray(this.data))t.push(this.data.length),t.push.apply(t,this.data);else if("number"==typeof this.data)t.push(1,this.data);else if(null!==this.data&&void 0!==this.data){t.push(this.data.length);var e=this.data.split("").map((function(t){return t.charCodeAt(0)}));t.push.apply(t,e)}else t.push(0);return t};var s=function(t){if(!this)return new s(t);var e=t||{};this.events=e.events||[]};s.START_BYTES=[77,84,114,107],s.END_BYTES=[0,255,47,0],s.prototype.addEvent=function(t){return this.events.push(t),this},s.prototype.addNoteOn=s.prototype.noteOn=function(t,i,s,a){return this.events.push(new n({type:n.NOTE_ON,channel:t,param1:r.ensureMidiPitch(i),param2:a||e,time:s||0})),this},s.prototype.addNoteOff=s.prototype.noteOff=function(t,i,s,a){return this.events.push(new n({type:n.NOTE_OFF,channel:t,param1:r.ensureMidiPitch(i),param2:a||e,time:s||0})),this},s.prototype.addNote=s.prototype.note=function(t,e,r,n,i){return this.noteOn(t,e,n,i),r&&this.noteOff(t,e,r,i),this},s.prototype.addChord=s.prototype.chord=function(t,e,r,n){if(!Array.isArray(e)&&!e.length)throw new Error("Chord must be an array of pitches");return e.forEach((function(e){this.noteOn(t,e,0,n)}),this),e.forEach((function(e,n){0===n?this.noteOff(t,e,r):this.noteOff(t,e)}),this),this},s.prototype.setInstrument=s.prototype.instrument=function(t,e,r){return this.events.push(new n({type:n.PROGRAM_CHANGE,channel:t,param1:e,time:r||0})),this},s.prototype.setTempo=s.prototype.tempo=function(t,e){return this.events.push(new i({type:i.TEMPO,data:r.mpqnFromBpm(t),time:e||0})),this},s.prototype.toBytes=function(){var t=0,e=[],n=s.START_BYTES,i=s.END_BYTES;this.events.forEach((function(r){var n=r.toBytes();t+=n.length,e.push.apply(e,n)})),t+=i.length;var a=r.str2Bytes(t.toString(16),4);return n.concat(a,e,i)};var a=function(t){if(!this)return new a(t);var e=t||{};if(e.ticks){if("number"!=typeof e.ticks)throw new Error("Ticks per beat must be a number!");if(e.ticks<=0||e.ticks>=32768||e.ticks%1!=0)throw new Error("Ticks per beat must be an integer between 1 and 32767!")}this.ticks=e.ticks||128,this.tracks=e.tracks||[]};a.HDR_CHUNKID="MThd",a.HDR_CHUNK_SIZE="\0\0\0",a.HDR_TYPE0="\0\0",a.HDR_TYPE1="\0",a.prototype.addTrack=function(t){return t?(this.tracks.push(t),this):(t=new s,this.tracks.push(t),t)},a.prototype.toBytes=function(){var t=this.tracks.length.toString(16),e=a.HDR_CHUNKID+a.HDR_CHUNK_SIZE;return parseInt(t,16)>1?e+=a.HDR_TYPE1:e+=a.HDR_TYPE0,e+=r.codes2Str(r.str2Bytes(t,2)),e+=String.fromCharCode(this.ticks/256,this.ticks%256),this.tracks.forEach((function(t){e+=r.codes2Str(t.toBytes())})),e},t.Util=r,t.File=a,t.Track=s,t.Event=n,t.MetaEvent=i}(n),null!==t?t.exports=n:null!==e?e=n:this.Midi=n},862:t=>{function e(t){var e=0;function r(r){var n=t.charCodeAt(e);return r&&n>127&&(n-=256),e+=1,n}return{eof:function(){return e>=t.length},read:function(r){var n=t.substr(e,r);return e+=r,n},readInt32:function(){var r=(t.charCodeAt(e)<<24)+(t.charCodeAt(e+1)<<16)+(t.charCodeAt(e+2)<<8)+t.charCodeAt(e+3);return e+=4,r},readInt16:function(){var r=(t.charCodeAt(e)<<8)+t.charCodeAt(e+1);return e+=2,r},readInt8:r,readVarInt:function(){for(var t=0;;){var e=r();if(!(128&e))return t+e;t+=127&e,t<<=7}}}}t.exports=function(t){return function(t){function r(t){var e=t.read(4),r=t.readInt32();return{id:e,length:r,data:t.read(r)}}var n;function i(t){var e={};e.deltaTime=t.readVarInt();var r,i=t.readInt8();if(240==(240&i)){if(255==i){e.type="meta";var s=t.readInt8(),a=t.readVarInt();switch(s){case 0:if(e.subtype="sequenceNumber",2!=a)throw"Expected length for sequenceNumber event is 2, got "+a;return e.number=t.readInt16(),e;case 1:return e.subtype="text",e.text=t.read(a),e;case 2:return e.subtype="copyrightNotice",e.text=t.read(a),e;case 3:return e.subtype="trackName",e.text=t.read(a),e;case 4:return e.subtype="instrumentName",e.text=t.read(a),e;case 5:return e.subtype="lyrics",e.text=t.read(a),e;case 6:return e.subtype="marker",e.text=t.read(a),e;case 7:return e.subtype="cuePoint",e.text=t.read(a),e;case 32:if(e.subtype="midiChannelPrefix",1!=a)throw"Expected length for midiChannelPrefix event is 1, got "+a;return e.channel=t.readInt8(),e;case 47:if(e.subtype="endOfTrack",0!=a)throw"Expected length for endOfTrack event is 0, got "+a;return e;case 81:if(e.subtype="setTempo",3!=a)throw"Expected length for setTempo event is 3, got "+a;return e.microsecondsPerBeat=(t.readInt8()<<16)+(t.readInt8()<<8)+t.readInt8(),e;case 84:if(e.subtype="smpteOffset",5!=a)throw"Expected length for smpteOffset event is 5, got "+a;var o=t.readInt8();return e.frameRate={0:24,32:25,64:29,96:30}[96&o],e.hour=31&o,e.min=t.readInt8(),e.sec=t.readInt8(),e.frame=t.readInt8(),e.subframe=t.readInt8(),e;case 88:if(e.subtype="timeSignature",4!=a)throw"Expected length for timeSignature event is 4, got "+a;return e.numerator=t.readInt8(),e.denominator=Math.pow(2,t.readInt8()),e.metronome=t.readInt8(),e.thirtyseconds=t.readInt8(),e;case 89:if(e.subtype="keySignature",2!=a)throw"Expected length for keySignature event is 2, got "+a;return e.key=t.readInt8(!0),e.scale=t.readInt8(),e;case 127:return e.subtype="sequencerSpecific",e.data=t.read(a),e;default:return e.subtype="unknown",e.data=t.read(a),e}return e.data=t.read(a),e}if(240==i)return e.type="sysEx",a=t.readVarInt(),e.data=t.read(a),e;if(247==i)return e.type="dividedSysEx",a=t.readVarInt(),e.data=t.read(a),e;throw"Unrecognised MIDI event type byte: "+i}0==(128&i)?(r=i,i=n):(r=t.readInt8(),n=i);var h=i>>4;switch(e.channel=15&i,e.type="channel",h){case 8:return e.subtype="noteOff",e.noteNumber=r,e.velocity=t.readInt8(),e;case 9:return e.noteNumber=r,e.velocity=t.readInt8(),0==e.velocity?e.subtype="noteOff":e.subtype="noteOn",e;case 10:return e.subtype="noteAftertouch",e.noteNumber=r,e.amount=t.readInt8(),e;case 11:return e.subtype="controller",e.controllerType=r,e.value=t.readInt8(),e;case 12:return e.subtype="programChange",e.programNumber=r,e;case 13:return e.subtype="channelAftertouch",e.amount=r,e;case 14:return e.subtype="pitchBend",e.value=r+(t.readInt8()<<7),e;default:throw"Unrecognised MIDI event type: "+h}}stream=e(t);var s=r(stream);if("MThd"!=s.id||6!=s.length)throw"Bad .mid file - header not found";var a=e(s.data),o=a.readInt16(),h=a.readInt16(),c=a.readInt16();if(32768&c)throw"Expressing time division in SMTPE frames is not supported yet";ticksPerBeat=c;for(var u={formatType:o,trackCount:h,ticksPerBeat},d=[],m=0;m<u.trackCount;m++){d[m]=[];var p=r(stream);if("MTrk"!=p.id)throw"Unexpected chunk - expected MTrk, got "+p.id;for(var l=e(p.data);!l.eof();){var f=i(l);d[m].push(f)}}return{header:u,tracks:d}}(t)}},179:(t,e,r)=>{"use strict";r.r(e),r.d(e,{create:()=>T,drumKitByPatchID:()=>b,fromJSON:()=>N,instrumentByPatchID:()=>l,instrumentFamilyByID:()=>f,load:()=>E,parse:()=>v});var n=r(862),i=r(126);function s(t){return"number"==typeof t}const a=function(){const t=/^([a-g]{1}(?:b|#|x|bb)?)(-?[0-9]+)/i;return e=>function(t){return"string"==typeof t}(e)&&t.test(e)}(),o=function(){const t=/^([a-g]{1}(?:b|#|x|bb)?)(-?[0-9]+)/i,e={cbb:-2,cb:-1,c:0,"c#":1,cx:2,dbb:0,db:1,d:2,"d#":3,dx:4,ebb:2,eb:3,e:4,"e#":5,ex:6,fbb:3,fb:4,f:5,"f#":6,fx:7,gbb:5,gb:6,g:7,"g#":8,gx:9,abb:7,ab:8,a:9,"a#":10,ax:11,bbb:9,bb:10,b:11,"b#":12,bx:13};return r=>{const n=t.exec(r),i=n[1],s=n[2];return e[i.toLowerCase()]+12*(parseInt(s)+1)}}();function h(t,e){if(t.length){const r=function(t,e){let r=0;const n=t.length;let i=n;if(n>0&&t[n-1].time<=e)return n-1;for(;r<i;){let n=Math.floor(r+(i-r)/2);const s=t[n],a=t[n+1];if(s.time===e){for(let r=n;r<t.length;r++)t[r].time===e&&(n=r);return n}if(s.time<e&&a.time>e)return n;s.time>e?i=n:s.time<e&&(r=n+1)}return-1}(t,e.time);t.splice(r+1,0,e)}else t.push(e)}const c={1:"modulationWheel",2:"breath",4:"footController",5:"portamentoTime",7:"volume",8:"balance",10:"pan",64:"sustain",65:"portamentoTime",66:"sostenuto",67:"softPedal",68:"legatoFootswitch",84:"portamentoContro"};class u{constructor(t,e,r){this.number=t,this.time=e,this.value=r}get name(){if(c.hasOwnProperty(this.number))return c[this.number]}}function d(t,e){for(let r=0;r<t.length;r++){let n=t[r],i=e[r];if(n.length>i)return!0}return!1}function m(t,e,r){let n=0,i=1/0;for(let r=0;r<t.length;r++){let s=t[r],a=e[r];s[a]&&s[a].time<i&&(n=r,i=s[a].time)}r[n](t[n][e[n]]),e[n]+=1}class p{static fromJSON(t){return new p(t.midi,t.time,t.duration,t.velocity)}constructor(t,e,r=0,n=1){if(s(t))this.midi=t;else{if(!a(t))throw new Error("the midi value must either be in Pitch Notation (e.g. C#4) or a midi value");this.name=t}this.time=e,this.duration=r,this.velocity=n}match(t){return s(t)?this.midi===t:a(t)?this.name.toLowerCase()===t.toLowerCase():void 0}get name(){return function(t){const e=Math.floor(t/12)-1;return["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"][t%12]+e}(this.midi)}set name(t){this.midi=o(t)}get noteOn(){return this.time}set noteOn(t){this.time=t}get noteOff(){return this.time+this.duration}set noteOff(t){this.duration=t-this.time}toJSON(){return{name:this.name,midi:this.midi,time:this.time,velocity:this.velocity,duration:this.duration}}}const l=["acoustic grand piano","bright acoustic piano","electric grand piano","honky-tonk piano","electric piano 1","electric piano 2","harpsichord","clavi","celesta","glockenspiel","music box","vibraphone","marimba","xylophone","tubular bells","dulcimer","drawbar organ","percussive organ","rock organ","church organ","reed organ","accordion","harmonica","tango accordion","acoustic guitar (nylon)","acoustic guitar (steel)","electric guitar (jazz)","electric guitar (clean)","electric guitar (muted)","overdriven guitar","distortion guitar","guitar harmonics","acoustic bass","electric bass (finger)","electric bass (pick)","fretless bass","slap bass 1","slap bass 2","synth bass 1","synth bass 2","violin","viola","cello","contrabass","tremolo strings","pizzicato strings","orchestral harp","timpani","string ensemble 1","string ensemble 2","synthstrings 1","synthstrings 2","choir aahs","voice oohs","synth voice","orchestra hit","trumpet","trombone","tuba","muted trumpet","french horn","brass section","synthbrass 1","synthbrass 2","soprano sax","alto sax","tenor sax","baritone sax","oboe","english horn","bassoon","clarinet","piccolo","flute","recorder","pan flute","blown bottle","shakuhachi","whistle","ocarina","lead 1 (square)","lead 2 (sawtooth)","lead 3 (calliope)","lead 4 (chiff)","lead 5 (charang)","lead 6 (voice)","lead 7 (fifths)","lead 8 (bass + lead)","pad 1 (new age)","pad 2 (warm)","pad 3 (polysynth)","pad 4 (choir)","pad 5 (bowed)","pad 6 (metallic)","pad 7 (halo)","pad 8 (sweep)","fx 1 (rain)","fx 2 (soundtrack)","fx 3 (crystal)","fx 4 (atmosphere)","fx 5 (brightness)","fx 6 (goblins)","fx 7 (echoes)","fx 8 (sci-fi)","sitar","banjo","shamisen","koto","kalimba","bag pipe","fiddle","shanai","tinkle bell","agogo","steel drums","woodblock","taiko drum","melodic tom","synth drum","reverse cymbal","guitar fret noise","breath noise","seashore","bird tweet","telephone ring","helicopter","applause","gunshot"],f=["piano","chromatic percussion","organ","guitar","bass","strings","ensemble","brass","reed","pipe","synth lead","synth pad","synth effects","ethnic","percussive","sound effects"],b={0:"standard kit",8:"room kit",16:"power kit",24:"electronic kit",25:"tr-808 kit",32:"jazz kit",40:"brush kit",48:"orchestra kit",56:"sound fx kit"};class y{static fromJSON(t){var e=new y(t.name,t.instrumentNumber,t.channelNumber);return e.id=t.id,t.notes&&t.notes.forEach((t=>{var r=p.fromJSON(t);e.notes.push(r)})),t.controlChanges&&(e.controlChanges=t.controlChanges),e}constructor(t,e=-1,r=-1){this.name=t,this.channelNumber=r,this.notes=[],this.controlChanges={},this.instrumentNumber=e}note(t,e,r=0,n=1){const i=new p(t,e,r,n);return h(this.notes,i),this}noteOn(t,e,r=1){const n=new p(t,e,0,r);return h(this.notes,n),this}noteOff(t,e){for(let r=0;r<this.notes.length;r++){let n=this.notes[r];if(n.match(t)&&0===n.duration){n.noteOff=e;break}}return this}cc(t,e,r){this.controlChanges.hasOwnProperty(t)||(this.controlChanges[t]=[]);const n=new u(t,e,r);return h(this.controlChanges[t],n),this}patch(t){return this.instrumentNumber=t,this}channel(t){return this.channelNumber=t,this}get noteOns(){const t=[];return this.notes.forEach((e=>{t.push({time:e.noteOn,midi:e.midi,name:e.name,velocity:e.velocity})})),t}get noteOffs(){const t=[];return this.notes.forEach((e=>{t.push({time:e.noteOff,midi:e.midi,name:e.name})})),t}get length(){return this.notes.length}get startTime(){return this.notes.length?this.notes[0].noteOn:0}get duration(){return this.notes.length?this.notes[this.notes.length-1].noteOff:0}get instrument(){return this.isPercussion?b[this.instrumentNumber]:l[this.instrumentNumber]}set instrument(t){const e=l.indexOf(t);-1!==e&&(this.instrumentNumber=e)}get isPercussion(){return[9,10].includes(this.channelNumber)}get instrumentFamily(){return this.isPercussion?"drums":f[Math.floor(this.instrumentNumber/8)]}scale(t){return this.notes.forEach((e=>{e.time*=t,e.duration*=t})),this}slice(t=0,e=this.duration){const r=Math.max(this.notes.findIndex((e=>e.time>=t)),0),n=this.notes.findIndex((t=>t.noteOff>=e))+1,i=new y(this.name);return i.notes=this.notes.slice(r,n),i.notes.forEach((e=>e.time=e.time-t)),i}encode(t,e){const r=e.PPQ/(60/e.bpm);let n=0;const i=Math.max(0,this.channelNumber);function s(t){const e=Math.floor(r*t),i=Math.max(e-n,0);return n=e,i}-1!==this.instrumentNumber&&t.instrument(i,this.instrumentNumber),function(...t){const e=t.filter(((t,e)=>e%2==0)),r=new Uint32Array(e.length),n=t.filter(((t,e)=>e%2==1));for(;d(e,r);)m(e,r,n)}(this.noteOns.sort(((t,e)=>t.time-e.time)),(e=>{t.addNoteOn(i,e.name,s(e.time),Math.floor(127*e.velocity))}),this.noteOffs.sort(((t,e)=>t.time-e.time)),(e=>{t.addNoteOff(i,e.name,s(e.time))}))}toJSON(){const t={startTime:this.startTime,duration:this.duration,length:this.length,notes:[],controlChanges:{}};return void 0!==this.id&&(t.id=this.id),t.name=this.name,-1!==this.instrumentNumber&&(t.instrumentNumber=this.instrumentNumber,t.instrument=this.instrument,t.instrumentFamily=this.instrumentFamily),-1!==this.channelNumber&&(t.channelNumber=this.channelNumber,t.isPercussion=this.isPercussion),this.notes.length&&(t.notes=this.notes.map((t=>t.toJSON()))),Object.keys(this.controlChanges).length&&(t.controlChanges=this.controlChanges),t}}class g{static fromJSON(t){var e=new g;return e.header=t.header,t.tracks.forEach((t=>{var r=y.fromJSON(t);e.tracks.push(r)})),e}constructor(){this.header={bpm:120,timeSignature:[4,4],PPQ:480},this.tracks=[]}load(t,e=null,r="GET"){return new Promise(((n,i)=>{var s=new XMLHttpRequest;s.open(r,t),s.responseType="arraybuffer",s.addEventListener("load",(()=>{4===s.readyState&&200===s.status?n(this.decode(s.response)):i(s.status)})),s.addEventListener("error",i),s.send(e)})).catch((function(t){console.log(t)}))}decode(t){if(t instanceof ArrayBuffer){var e=new Uint8Array(t);t=String.fromCharCode.apply(null,e)}const r=n(t);return this.header=function(t){for(var e={PPQ:t.header.ticksPerBeat},r=0;r<t.tracks.length;r++)for(var n=t.tracks[r],i=0;i<n.length;i++){var s=n[i];"meta"===s.type&&("timeSignature"===s.subtype?e.timeSignature=[s.numerator,s.denominator]:"setTempo"===s.subtype&&(e.bpm||(e.bpm=6e7/s.microsecondsPerBeat)))}return e.bpm=e.bpm||120,e}(r),this.tracks=[],r.tracks.forEach(((t,e)=>{const r=new y;r.id=e,this.tracks.push(r);let n=0;t.forEach((t=>{var e,i;n+=(e=t.deltaTime,60/(i=this.header).bpm*(e/i.PPQ)),"meta"===t.type&&"trackName"===t.subtype?r.name=t.text.replace(/\u0000/g,""):"noteOn"===t.subtype?(r.noteOn(t.noteNumber,n,t.velocity/127),-1===r.channelNumber&&(r.channelNumber=t.channel)):"noteOff"===t.subtype?r.noteOff(t.noteNumber,n):"controller"===t.subtype&&t.controllerType?r.cc(t.controllerType,n,t.value/127):"meta"===t.type&&"instrumentName"===t.subtype?r.instrument=t.text:"channel"===t.type&&"programChange"===t.subtype&&(r.patch(t.programNumber),r.channelNumber=t.channel)})),this.header.name||r.length||!r.name||(this.header.name=r.name)})),this}encode(){const t=new i.File({ticks:this.header.PPQ}),e=this.tracks.filter((t=>!t.length))[0];return!this.header.name||e&&e.name===this.header.name||t.addTrack().addEvent(new i.MetaEvent({time:0,type:i.MetaEvent.TRACK_NAME,data:this.header.name})),this.tracks.forEach((e=>{const r=t.addTrack();r.setTempo(this.bpm),e.name&&r.addEvent(new i.MetaEvent({time:0,type:i.MetaEvent.TRACK_NAME,data:e.name})),e.encode(r,this.header)})),t.toBytes()}toArray(){const t=this.encode(),e=new Array(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}toJSON(){const t={header:this.header,startTime:this.startTime,duration:this.duration,tracks:(this.tracks||[]).map((t=>t.toJSON()))};return t.header.name||(t.header.name=""),t}track(t){const e=new y(t);return this.tracks.push(e),e}get(t){return s(t)?this.tracks[t]:this.tracks.find((e=>e.name===t))}slice(t=0,e=this.duration){const r=new g;return r.header=this.header,r.tracks=this.tracks.map((r=>r.slice(t,e))),r}get startTime(){const t=this.tracks.map((t=>t.startTime));return t.length&&Math.min.apply(Math,t)||0}get bpm(){return this.header.bpm}set bpm(t){const e=this.header.bpm;this.header.bpm=t;const r=e/t;this.tracks.forEach((t=>t.scale(r)))}get timeSignature(){return this.header.timeSignature}set timeSignature(t){this.header.timeSignature=t}get duration(){const t=this.tracks.map((t=>t.duration));return t.length&&Math.max.apply(Math,t)||0}}function v(t){return(new g).decode(t)}function E(t,e){const r=(new g).load(t);return e&&r.then(e),r}function T(){return new g}function N(t){return g.fromJSON(t)}}},r={};function n(t){var i=r[t];if(void 0!==i)return i.exports;var s=r[t]={id:t,loaded:!1,exports:{}};return e[t].call(s.exports,s,s.exports,n),s.loaded=!0,s.exports}n.d=(t,e)=>{for(var r in e)n.o(e,r)&&!n.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.nmd=t=>(t.paths=[],t.children||(t.children=[]),t),t=n(179),window.MidiConvert=t})();